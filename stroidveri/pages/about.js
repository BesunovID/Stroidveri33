import Head from "next/head"
import Image from "next/image"
import style from "../styles/About.module.scss"

export default function About( {posts} ) {
    return(
        <div className="1">
            <Head>
                <title>О компании</title>
                <meta name="description" content="Generated by create next app" />
                <link rel="icon" href="/favicon.ico" />
            </Head>
            <div className={style.advantages}>
                {posts.lenght !== 0 ? (
                    posts.map((post) => ( 
                        <Post key={post.id} data={post} />
                    ))
                ): (
                    <div> Ошибка, попробуйте позже</div>
                )}
            </div>
        </div>
    )
}

const Post = ({ data }) => {
    return(
        <div key={data.id} className={(data.id % 2) == 0 ?
            style.post : `${style.post} ${style.left}`}>
            {data.id != '1' ? (<div className={style.image}>
                <Image
                    src={data.image}
                    alt={data.head}
                    layout='fill'
                />
            </div>) : ''}
            <div className={style.data}>
                <div className={style.name}>
                    <p>{data.head}</p>
                </div>
                <div className={style.description}>
                    <p>{data.desc}</p>
                </div>
            </div>
        </div>
    )
}


export async function getStaticProps() {
    const res = await fetch('http://localhost:3000//api/aboutPosts');
    const posts = await res.json();

    if(!posts) {
        return{
            notFound: true,
        };
    }

    return{
        props: {
            posts,
        },
    };
}